{"meta":{"title":"å¤§æ¸”å°äºˆ","subtitle":"","description":"å¤§æ¸”å°äºˆ","author":"muxq","url":"http://localhost:4000","root":"/"},"pages":[{"title":"categories","date":"2022-07-29T08:48:46.000Z","updated":"2022-07-29T08:49:15.740Z","comments":true,"path":"categories/index.html","permalink":"http://localhost:4000/categories/index.html","excerpt":"","text":""},{"title":"about","date":"2022-07-29T08:52:25.000Z","updated":"2022-07-29T08:52:35.877Z","comments":true,"path":"about/index.html","permalink":"http://localhost:4000/about/index.html","excerpt":"","text":""},{"title":"tags","date":"2022-07-29T08:47:49.000Z","updated":"2022-07-29T08:48:11.278Z","comments":true,"path":"tags/index.html","permalink":"http://localhost:4000/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Windowsåè°ƒè¯•æŠ€æœ¯","slug":"antidebug01","date":"2022-07-29T09:36:47.000Z","updated":"2022-08-02T09:38:24.160Z","comments":true,"path":"2022/07/29/antidebug01/","link":"","permalink":"http://localhost:4000/2022/07/29/antidebug01/","excerpt":"å‰è¨€é¦–å…ˆæ„Ÿè°¢ github å’Œ hexoï¼Œè®©è‡ªå·±èƒ½å¤Ÿç™½ piao ä¸€æŠŠï¼Œè½»æ¾æ­å»ºä¸€ä¸ªå±äºè‡ªå·±çš„åšå®¢ï¼Œèƒ½å¤Ÿæœ‰ä¸€ä¸ªè®°å½•ï¼Œåˆ†äº«å’Œå­¦ä¹ çš„å¹³å°ï¼Œå¼€æºï¼Œæ˜¯è¿™ä¸ªä¸–ç•Œæœ€ä¼Ÿå¤§çš„å‘æ˜ï¼ å¼€å¯æœ¬ç¯‡åšæ–‡çš„æ­£é¢˜ï¼Œè¯¥ç¯‡åšæ–‡ä¸»è¦è®²è§£åšä¸»ä»æ¥è§¦åˆ°ä½¿ç”¨åè°ƒè¯•å·¥å…·çš„ä¸€äº›ç»éªŒï¼Œå¦‚æœä½ å·²æ˜¯é€†å‘å¤§ç¥ï¼Œè¯·æŒ‡æ­£æ–‡ä¸­çš„ä¸æ­£ç¡®çš„ä¹‹å¤„ï¼Œåšä¸»åœ¨è¿™é‡Œä¸èƒœæ„Ÿæ¿€ï¼Œæˆ‘ä¹Ÿæ˜¯é€†å‘ç•Œçš„å°å­¦ç”Ÿï¼Œå¸Œæœ›é€šè¿‡åšå®¢ç»“è¯†å¯¹é€†å‘æ„Ÿå…´è¶£çš„æœ‹å‹å…±åŒå­¦ä¹ å’Œçªç ´ã€‚åœ¨æ²¡æœ‰æ¥è§¦åè°ƒè¯•å·¥å…·å‰ï¼Œä¸€ç›´è®¤ PE ç¨‹åºé€†å‘æ˜¯ä¸€ä»¶éå¸¸å›°éš¾çš„äº‹æƒ…ï¼Œç›¸ä¿¡å¾ˆå¤š Windows ç¨‹åºå‘˜éƒ½å­˜åœ¨è¿™æ ·çš„è§‚ç‚¹ã€‚ç¢°å·§åœ¨å·¥ä½œä¸­ä¹Ÿé‡åˆ°è¿‡éœ€è¦å®ç°ä¿æŠ¤è‡ªå·±ç¨‹åºçš„éœ€æ±‚ï¼Œè¿™æ—¶å€™æ‡µæ‡‚çš„äº†è§£äº†ä»£ç æ··æ·†ï¼Œç¨‹åºåŠ å£³çš„æ¦‚å¿µï¼Œä½†æ˜¯å½“æ—¶å¹¶ä¸çš„è¿™äº›æ‰‹æ®µå¯¹ Windows ç¨‹åºå‘˜å¼€å‘çš„ç¨‹åºæœ‰å¤šå¤§ä½œç”¨ï¼Œç›´åˆ°æœ€è¿‘ï¼Œå·¥ä½œä¸­éœ€è¦å¯¹ç«å“åˆ†æï¼Œåˆ†æåŒè¡Œäº§å“ä¸­æŸä¸€åŠŸèƒ½çš„å®ç°åŸç†ï¼Œæ‰å¯¹é€†å‘æœ‰äº†ä¸€å®šçš„è®¤çŸ¥ï¼Œéšç€ä¸æ–­çš„äº†è§£ï¼Œå‘ç°åŸæ¥è‡ªå·±å†™çš„ç¨‹åºéƒ½åœ¨â€è£¸å¥”â€ã€‚ æœ¬ç¯‡å°†ç»“åˆå®é™…ç”¨ä¾‹æ¥è¯´æ˜å¦‚ä½•å®ç°é™æ€å’ŒåŠ¨æ€é€†å‘åˆ†æã€‚","text":"å‰è¨€é¦–å…ˆæ„Ÿè°¢ github å’Œ hexoï¼Œè®©è‡ªå·±èƒ½å¤Ÿç™½ piao ä¸€æŠŠï¼Œè½»æ¾æ­å»ºä¸€ä¸ªå±äºè‡ªå·±çš„åšå®¢ï¼Œèƒ½å¤Ÿæœ‰ä¸€ä¸ªè®°å½•ï¼Œåˆ†äº«å’Œå­¦ä¹ çš„å¹³å°ï¼Œå¼€æºï¼Œæ˜¯è¿™ä¸ªä¸–ç•Œæœ€ä¼Ÿå¤§çš„å‘æ˜ï¼ å¼€å¯æœ¬ç¯‡åšæ–‡çš„æ­£é¢˜ï¼Œè¯¥ç¯‡åšæ–‡ä¸»è¦è®²è§£åšä¸»ä»æ¥è§¦åˆ°ä½¿ç”¨åè°ƒè¯•å·¥å…·çš„ä¸€äº›ç»éªŒï¼Œå¦‚æœä½ å·²æ˜¯é€†å‘å¤§ç¥ï¼Œè¯·æŒ‡æ­£æ–‡ä¸­çš„ä¸æ­£ç¡®çš„ä¹‹å¤„ï¼Œåšä¸»åœ¨è¿™é‡Œä¸èƒœæ„Ÿæ¿€ï¼Œæˆ‘ä¹Ÿæ˜¯é€†å‘ç•Œçš„å°å­¦ç”Ÿï¼Œå¸Œæœ›é€šè¿‡åšå®¢ç»“è¯†å¯¹é€†å‘æ„Ÿå…´è¶£çš„æœ‹å‹å…±åŒå­¦ä¹ å’Œçªç ´ã€‚åœ¨æ²¡æœ‰æ¥è§¦åè°ƒè¯•å·¥å…·å‰ï¼Œä¸€ç›´è®¤ PE ç¨‹åºé€†å‘æ˜¯ä¸€ä»¶éå¸¸å›°éš¾çš„äº‹æƒ…ï¼Œç›¸ä¿¡å¾ˆå¤š Windows ç¨‹åºå‘˜éƒ½å­˜åœ¨è¿™æ ·çš„è§‚ç‚¹ã€‚ç¢°å·§åœ¨å·¥ä½œä¸­ä¹Ÿé‡åˆ°è¿‡éœ€è¦å®ç°ä¿æŠ¤è‡ªå·±ç¨‹åºçš„éœ€æ±‚ï¼Œè¿™æ—¶å€™æ‡µæ‡‚çš„äº†è§£äº†ä»£ç æ··æ·†ï¼Œç¨‹åºåŠ å£³çš„æ¦‚å¿µï¼Œä½†æ˜¯å½“æ—¶å¹¶ä¸çš„è¿™äº›æ‰‹æ®µå¯¹ Windows ç¨‹åºå‘˜å¼€å‘çš„ç¨‹åºæœ‰å¤šå¤§ä½œç”¨ï¼Œç›´åˆ°æœ€è¿‘ï¼Œå·¥ä½œä¸­éœ€è¦å¯¹ç«å“åˆ†æï¼Œåˆ†æåŒè¡Œäº§å“ä¸­æŸä¸€åŠŸèƒ½çš„å®ç°åŸç†ï¼Œæ‰å¯¹é€†å‘æœ‰äº†ä¸€å®šçš„è®¤çŸ¥ï¼Œéšç€ä¸æ–­çš„äº†è§£ï¼Œå‘ç°åŸæ¥è‡ªå·±å†™çš„ç¨‹åºéƒ½åœ¨â€è£¸å¥”â€ã€‚ æœ¬ç¯‡å°†ç»“åˆå®é™…ç”¨ä¾‹æ¥è¯´æ˜å¦‚ä½•å®ç°é™æ€å’ŒåŠ¨æ€é€†å‘åˆ†æã€‚ ç†è®ºçŸ¥è¯† æœ¬ç¯‡æ‰€è¿°å‡åŸºäº Windowns æ“ä½œç³»ç»Ÿï¼ˆè¿™é‡Œå…ˆæ˜ ä¸‹é¢˜ ğŸ‘ˆï¼‰ æ¦‚å¿µ Windows PE(Preinstallation Environment - é¢„å®‰è£…ç¯å¢ƒ)å¯æ‰§è¡Œç¨‹åº Windows åº”ç”¨ç¨‹åºå¼€å‘ï¼Œæ˜¯é¢å‘ Windows API å¼€å‘ï¼Œè¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸Šï¼ˆè¿™ç‚¹å¾ˆé‡è¦ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬èƒ½å¤Ÿé€†å‘çš„åŸºç¡€ï¼‰ é€†å‘åˆ†ä¸ºé™æ€å’ŒåŠ¨æ€ï¼ŒåŠ¨æ€åˆ†æå’Œé™æ€åˆ†æéƒ½é€†å‘çš„ä¸€ç§æ‰‹æ®µï¼Œä¸¤è€…ç›¸è¾…ç›¸æˆï¼Œåœ¨é™æ€æ— æ³•åˆ†æå‡ºå®ç°è¿‡ç¨‹æ—¶ï¼Œå¯ç»“åˆåŠ¨æ€åˆ†æï¼Œåä¹‹äº¦ç„¶ã€‚ æŠ€æœ¯ æ‡‚ä¸€äº›æ±‡ç¼–çŸ¥è¯† æœ‰ä¸€å®šçš„ Windows ç¼–ç¨‹åŸºç¡€(å¼€å‘è¯­è¨€æ— å…³) èƒ½å¤Ÿç†Ÿç»ƒæœç´¢ Windows API å¸®åŠ©æ–‡æ¡£(è¿™ä¸ªå¾ˆé‡è¦) ç†Ÿç»ƒçš„è¿ç”¨é€†å‘å·¥å…· åè°ƒè¯•å·¥å…· é™æ€ IDA Pro &#x2F;&#x2F;æ¨èä½¿ç”¨, free ç‰ˆæœ¬åªæ”¯æŒ x64 ghidra &#x2F;&#x2F;å¼€æºé€†å‘å·¥å…·åª²ç¾ IDA åŠ¨æ€ OllyDbg &#x2F;&#x2F;å¾ˆä¹…æœªç»´æŠ¤ï¼Œåªæ”¯æŒ x86 x64Dbg &#x2F;&#x2F;æ¨èä½¿ç”¨ï¼Œæ”¯æŒ x86 å’Œ x64 api-monitor &#x2F;&#x2F;api ç›‘æ§ç¨‹åºï¼Œä¾¿äºåˆ†æç¨‹åºè¡Œä¸ºï¼Œå’Œå¯»æ‰¾é€†å‘å…³é”®ç‚¹ åè°ƒè¯•çš„åŸç†ï¼ŒåŸºäº PE æ–‡ä»¶çš„ç»“æ„åŸç†ï¼Œå’Œåº”ç”¨ç¨‹åºå¯¹ç³»ç»Ÿ API çš„ä¾èµ–ï¼Œé€šè¿‡åˆ†æåº”ç”¨ç¨‹åºæ‰€ä½¿ç”¨åˆ°çš„ç³»ç»Ÿ API å’Œä¾èµ–çš„èµ„æºæ–‡ä»¶æ¥é€†å‘å‡ºåº”ç”¨ç¨‹åºæ‰€å®ç°çš„åŠŸèƒ½ã€‚Windows ç¨‹åºéƒ½æ˜¯é¢å‘æ¥å£çš„ç¼–ç¨‹ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å°† Windows æ“ä½œç³»ç»Ÿæ¯”å–»ä¸ºä¸€è¾†æ±½è½¦ï¼Œå°†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ¯”å–»ä¸ºæ²¹é—¨ï¼Œè„šåˆ¹å’Œæ–¹å‘ç›˜ï¼Œä½ è¦å»å“ªé‡Œå’Œæ€ä¹ˆèµ°å°±æ˜¯ Windows ç¨‹åºå‘˜ç¼–ç¨‹(é¢å‘ API)æ‰€å®ç°çš„åŠŸèƒ½ã€‚ æˆ‘ä»¬åœ¨é€†å‘åˆ«äººç¨‹åºæ—¶ï¼Œä¸å¼ºåˆ¶è¦æ±‚ä½¿ç”¨å“ªä¸ªå·¥å…·ï¼Œä¸€åˆ‡ä»¥ç›®çš„ä¸ºå¯¼å‘ï¼Œèƒ½å¤ŸæˆåŠŸé€†å‘å‡ºåº”ç”¨ç¨‹åºçš„å®ç°éƒ½æ˜¯å¥½å·¥å…·(ğŸ™‹) ï¼ŒåŒæ—¶ä½ ä¹Ÿå¯å†™ä¸€äº›é€†å‘å·¥å…·çš„æ’ä»¶ã€‚åœ¨é€†å‘çš„ä¸–ç•Œé‡Œï¼ŒIDA ä¸ OD è¢«å½¢è±¡çš„æ¯”å–»ä¸ºå€šå¤©å‰‘å’Œå± é¾™åˆ€ï¼Œå¾—æ­¤äºŒè€…åŸºæœ¬å¯ä»¥å·ä»¤å¤©ä¸‹äº† ğŸ˜… é™æ€åˆ†æé™æ€åˆ†æ æ˜¯æŒ‡ä½¿ç”¨é€†å‘å·¥å…·æ¥åˆ†æåº”ç”¨ç¨‹åºçš„æŸä¸ªæ¨¡å—ï¼Œå¯¹ï¼Œå°±æ˜¯å­—é¢çš„æ„æ€ï¼Œé‚£ä¸ºä»€ä¹ˆéœ€è¦é™æ€åˆ†æå‘¢ï¼Ÿä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š 1.åº”ç”¨ç¨‹åºåªèƒ½éƒ¨åˆ†æ‹·è´ 2.è¿è¡Œç¯å¢ƒä¾èµ–ï¼Œå®é™…è¿è¡Œæœ‰ä¾èµ–ï¼Œå¦‚æœç”¨æˆ·çš„å£ä»¤è®¤è¯ç­‰ 3.åº”ç”¨ç¨‹åºå¤ªå¤§ï¼Œå®é™…åˆ†æçš„åŠŸèƒ½ä»…åœ¨ä¸€ä¸ª dll æ¨¡å—å†… æˆ‘ä»¬ç”¨ C++æ¥å®ç°ä¸€ä¸ªç®€å•çš„åŠ¨æ€é“¾æ¥åº“æ¨¡å—static_anti_dll_01.dllï¼Œæºç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728#include &lt;Windows.h&gt;#include &lt;stdio.h&gt;static const char *g_defult_msg = &quot;guest&quot;;extern &quot;C&quot; __declspec(dllexport) void say_hello(const char *msg) &#123; if (msg) &#123; fprintf(stdout, &quot;hello %s\\n&quot;, msg); &#125; else &#123; fprintf(stdout, &quot;hello %s\\n&quot;, g_defult_msg); &#125;&#125;extern &quot;C&quot; __declspec(dllexport) bool GetSystemVersion(int &amp;major, int &amp;minor) &#123; OSVERSIONINFO osvi; BOOL bIsWindowsXPorLater; ZeroMemory(&amp;osvi, sizeof(OSVERSIONINFO)); osvi.dwOSVersionInfoSize = sizeof(OSVERSIONINFO); if (!GetVersionEx(&amp;osvi)) &#123; fprintf(stderr, &quot;get system version failed\\n&quot;); return false; &#125; major = osvi.dwMajorVersion; minor = osvi.dwMinorVersion; return true;&#125; ä¸Šé¢çš„ä»£ç ç›¸ä¿¡å¤§å®¶èƒ½å¤Ÿçœ‹æ‡‚ï¼Œsay_helloå‡½æ•°ç”¨æ¥æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºï¼ŒGetSystemVersionç”¨æ¥è·å–å½“å‰çš„æ“ä½œç³»ç»Ÿç‰ˆæœ¬å·ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¼€å§‹å¯¹å®ƒè¿›è¡Œé™æ€é€†å‘åˆ†æ 1.é¦–å…ˆä½¿ç”¨ IDA åŠ è½½è¿™ä¸ª dllé»˜è®¤å…¶ä»–é€‰é¡¹ï¼Œç‚¹å‡» [OK] 2.IDA Pro ä¼šé™æ€çš„è§£æè¯¥ DLL æ±‡ç¼–å’Œèµ„æºç­‰ä¿¡æ¯é»˜è®¤ç¬¬ä¸€ä¸ªå‡ºç°åœ¨é€†å‘çª—å£çš„å‡½æ•°æ˜¯å…¥å£å‡½æ•°ï¼Œè¯¦ç»†å¦‚ä¸Šå›¾ 03.æ­¤å®æˆ‘ä»¬åœ¨å…¥å£å‡½æ•°æŒ‰ F5 æŒ‰é”®ï¼ŒIDA ä¼šè‡ªåŠ¨çš„å¸®åŠ©æˆ‘ä»¬åˆ†ææ±‡ç¼–ä»£ç ï¼Œå½¢æˆå¯¹åº”çš„ä¼ªä»£ç ä»ä¸Šå›¾å¯çŸ¥ï¼Œè¿™æ—¶çš„ä»£ç åŸºæœ¬ä¸Šèƒ½å¤Ÿçœ‹æ‡‚äº†ï¼Œä¹‹æ‰€ä»¥è¯´ IDA æ¯”è¾ƒä¼Ÿå¤§ï¼Œæ˜¯å› ä¸ºå®ƒä¸ºæˆ‘ä»¬ç”Ÿæˆçš„ ä¼ªä»£ç å¯è¯»æ€§è¾ƒé«˜ ï¼ŒåŒç†ä½ å¯ä»¥ä½¿ç”¨å…¶ä»–çš„é™æ€é€†å‘å·¥å…·æ¥åˆ†æå¯¹æ¯”ä¸‹ã€‚ 04.ä¸€èˆ¬çš„è¦åˆ†æ DLL æä¾›äº†å“ªäº›åŠŸèƒ½ï¼Œé¦–å…ˆæŸ¥çœ‹è¿™ä¸ª DLL çš„å¯¼å‡ºå‡½æ•°è¡¨å¯¼å‡ºå‡½æ•°æ˜¯æˆ‘ä»¬åˆ†æè¿™ä¸ª dll çš„ç›´è§‚å…¥å£ï¼Œå› ä¸º dll é€šè¿‡å¯¼å‡ºæ¥å£æ¥æä¾›æœåŠ¡ï¼Œæ‰€ä»¥é€šè¿‡æä¾›çš„å‡½æ•°åç§°åŸºæœ¬å¯æ¨æ–­å‡ºè¿™ä¸ª dll æä¾›äº†å“ªäº›åŠŸèƒ½ï¼Œä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“å‰è¢«åˆ†æçš„ dll æä¾›äº† 3 ä¸ªæ¥å£ï¼ˆDllEntryPointã€say_hello å’Œ GetSystemVersionï¼‰ï¼Œå¦‚æœä½ è¦åˆ†æ dll åœ¨è¢«åŠ è½½æ—¶åšäº†å“ªäº›åˆå§‹åŒ–ï¼Œä½ å¯ä»¥é€šè¿‡ DllEntryPoint å…¥å£å‡½æ•°æ¥åˆ†æï¼Œå› ä¸ºè¿™ä¸ªå…¥å£å‡½æ•°åœ¨DllMainå‰è¢«æ‰§è¡Œï¼Œæ‰€ä»¥ä¸€äº›å…¨å±€å˜é‡çš„å€¼ï¼Œå¯ä»¥åœ¨è¿™ä¸ªå‡½æ•°ä¸­è¿›è¡Œåˆ†æï¼ŒåŒæ—¶è¿™ä¸ªå‡½æ•°ä¹Ÿæ˜¯æ‰¾DllMainçš„å…¥å£ï¼Œæˆ–è€…ä½ å¯ä»¥åœ¨ å‡½æ•°çª—å£ ä¸­å»æœç´¢DllMainã€‚ 05. é™æ€é€†å‘åˆ†æå¯¼å‡ºæ¥å£å®ç° 1.å¯¹å‡½æ•°say_helloè¿›è¡Œåˆ†ææˆ‘ä»¬åœ¨å¯¼å‡ºæ¥å£ï¼Œé¼ æ ‡å·¦é”®åŒå‡»è¯¥å‡½æ•°ï¼ŒIDA ä¼šè‡ªåŠ¨çš„ç”Ÿæˆï¼Œå…³äºè¯¥å‡½æ•°çš„æ±‡ç¼–ä»£ç è°ƒç”¨å›¾æ ‡ï¼Œæ­¤æ—¶æŒ‰F5IDAä¼šä¸ºæˆ‘ä»¬ç”ŸæˆåŸºäºå½“å‰å‡½æ•°çš„ä¼ªä»£ç ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šè‡³æ­¤ IDA å·²ç»ä¸ºæˆ‘ä»¬åšäº†å¾ˆå¤šï¼Œå‰©ä¸‹é€†å‘äº¤ç»™æˆ‘ä»¬ï¼Œå¯¹ä¼ªä»£ç åšå¦‚ä¸‹è§£æï¼š 1&gt; ä»hello %s\\nå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æ–­å‡ºv3å¾ˆå¯èƒ½æ˜¯char * 2&gt; è¿›ä¸€æ­¥è§£æï¼Œå¦‚æœ a1 ä¸ä¸ºç©ºèµ‹å€¼ç»™ v3 æŒ‡é’ˆï¼Œå¦‚æœä¸ºç©ºæŒ‡å‘ä¸€ä¸ªå…¨å±€åœ°å€ï¼Œæš‚ä¸”å…ˆä¸ç®¡è¿™ä¸ªå…¨å±€åœ°å€æ˜¯ä»€ä¹ˆ 3&gt; ç¬¬ 10 è¡Œé€šè¿‡_acrt_iob_funcå¾—åˆ°æ–‡ä»¶æŒ‡é’ˆï¼Œç»æŸ¥è¿™ä¸ªå‡½æ•°ç”¨æ¥è·å–æ ‡å‡†è¾“å‡ºæŒ‡é’ˆ 4&gt; ç¬¬ 11 è¡Œï¼Œå°†æ ‡å‡†è¾“å‡ºå’Œ v3 å˜é‡ä½œä¸ºå‚æ•°ï¼Œè°ƒç”¨sub_100010B0ï¼ŒæŸ¥çœ‹æ­¤å‡½æ•°å®ç°ï¼Œä¼šå‘ç°è¯¥å‡½æ•°è°ƒç”¨_stdio_common_vfprintfè¿›è¡Œæ ¼å¼åŒ–è¾“å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡ŒåŸºæœ¬å¾—å‡ºè¯¥å‡½æ•°æ˜¯ç”¨äºæ ‡å‡†åŒ–è¾“å‡º 5&gt; æˆ‘ä»¬å†å›è¿‡å¤´å»åˆ†æä¸‹å…¨å±€å˜é‡unk_10003000ï¼Œ åŒå‡»åå…¨å±€å˜é‡ï¼Œè·³è½¬åˆ°æ±‡ç¼–çª—å£unk_10003000 db 0B0h ; OFF32 SEGDEF [_rdata,100020B0]ï¼Œè¯¥åœ°å€å­˜å‚¨çš„æ˜¯_rdataè¡¨çš„100020B0åœ°å€å¤„, è·³è½¬åˆ°è¯¥åœ°å€æŸ¥çœ‹å†…å­˜ä¿¡æ¯ã€‚ç»è¿‡æˆ‘ä»¬åˆ†æåçš„å‡½æ•°å®ç°å¦‚ä¸‹ï¼š 2.åŒç†å¯¹å‡½æ•°GetSystemVersionåˆ†æåå¦‚ä¸‹æ‰€ç¤º: ä»ä¸Šé¢ç»™å‡ºçš„ä¸¤ä¸ªå‡½æ•°çš„é™æ€åˆ†æï¼Œä½ æ˜¯å¦è¿˜è§‰å¾—è‡ªå·±å†™çš„ç¨‹åºè¶³å¤Ÿå®‰å…¨ï¼Ÿ åŠ¨æ€åˆ†æåŠ¨æ€åˆ†æ æ˜¯æŒ‡é€šè¿‡ä½¿ç”¨åè°ƒè¯•ç¨‹åºå¯åŠ¨åº”ç”¨ç¨‹åºï¼Œæˆ–è€…é™„åŠ åˆ°åº”ç”¨ç¨‹åºï¼Œé€šè¿‡è°ƒè¯•å’ŒæŸ¥çœ‹åº”ç”¨ç¨‹åºå†…å­˜çš„å˜åŒ–æ¥è¾¾åˆ°é€†å‘åˆ†æçš„æ‰‹æ®µåº”ç”¨ç¨‹åºå¯èƒ½å­˜åœ¨åŠ¨æ€å¾—è®¡ç®—ï¼Œæ¯”å¦‚ï¼š å®¢æˆ·ç«¯çš„æŸä¸ªåŠŸèƒ½éœ€è¦æœåŠ¡ç«¯çš„è¾“å…¥ä½œä¸ºå‚æ•°ï¼Œæˆ–è€…åŒæ–¹éƒ½éœ€è¦é€šè¿‡ä¸€å®šçš„è®¡ç®—æ‰èƒ½éªŒè¯é€šè¿‡ï¼Œè¿™ä¸ªæ—¶å€™çš„é™æ€åˆ†æå¯èƒ½æ— æ³•é€†å‘å‡ºåŸç†ï¼Œéœ€è¦åŠ¨æ€é€†å‘çš„ååŠ©ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¯´åŠ¨æ€å’Œé™æ€åˆ†æéƒ½é‡è¦ï¼Œåªè¦èƒ½å¤Ÿè¾¾åˆ°ç›®çš„å³å¯ã€‚å‘ç°é€šè¿‡ IDA çš„èœå•ï¼Œå¯ä»¥çœ‹åˆ°æœ‰Debuggerèœå•ï¼ŒIDA ä¹Ÿæä¾›äº†åŠ¨æ€è°ƒè¯•ï¼Œä½†æ˜¯ç›¸è¾ƒäºä¸“ç”¨çš„åŠ¨æ€é€†å‘å·¥å…·æ¥è¯´ï¼ŒåŠŸèƒ½è¿˜æ˜¯ä¸å¤Ÿå…¨é¢ï¼Œæ‰€ä»¥è¿™é‡Œå»ºè®®åŠ¨æ€åˆ†ææ—¶ï¼Œä½¿ç”¨æ¨èçš„å·¥å…·è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨x64Dbgå·¥å…·å¯¹åº”ç”¨ç¨‹åºè¿›è¡Œåˆ†æã€‚åŠ¨æ€è°ƒè¯•æ¯”è¾ƒè®²ç©¶æŠ€å·§ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦æœ‰ä¸€å®šçš„æ±‡ç¼–åŸºç¡€ï¼Œå› ä¸ºå®ƒä¸åƒ IDAä¼šä¸ºä½ ç”Ÿæˆä¼ªä»£ç ï¼ŒåŠ¨æ€é€†å‘æ—¶ï¼Œä½ åªèƒ½çœ‹åˆ°ä¼ªä»£ç ï¼Œæ‰€ä»¥æ¯”è¾ƒé€‚åˆæœ‰é’ˆå¯¹æ€§çš„ç ´è§£ã€‚â— ä¸€èˆ¬æƒ…å†µä¸‹ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œåœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸­ï¼Œè¢«åŠ è½½åˆ°å†…å­˜åçš„ VA åœ°å€ä¸ä¼šå˜åŒ–ï¼Œå› ä¸ºæ¯ä¸ªè¿›ç¨‹éƒ½æ‹¥æœ‰ç›¸åŒå¤§å°çš„åœ°å€ç©ºé—´ï¼Œåº”ç”¨ç¨‹åºå¯åŠ¨çš„åŸºåœ°å€æ¯æ¬¡ä¹Ÿéƒ½ç›¸åŒï¼Œæ‰€ä»¥åº”ç”¨ç¨‹åºä¸­çš„è™šæ‹Ÿåœ°å€ä¸ä¼šå‘ç”Ÿå˜åŒ–æˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ªå®é™…çš„ç”¨ä¾‹æ¥æ¼”ç¤ºï¼Œå¦‚ä½•ä½¿ç”¨x64dbgï¼Œç¨‹åºçš„æºç ã€‚ åŠ¨æ€é€†å‘ç™»å½•å°ç¨‹åºç™»å½•å°ç¨‹åºçš„å®ç°é€»è¾‘å¦‚ä¸‹ï¼š é€šè¿‡åŠ¨æ€åˆ†æè¿™ä¸ªç®€å•çš„å°ç¨‹åºï¼Œå¯ä»¥è®©å¤§å®¶äº†è§£å¦‚ä½•å»é€†å‘å®ƒï¼Œé€†å‘æ­¥éª¤å¦‚ä¸‹ï¼š 1.åœ¨é€†å‘å‰ï¼Œé¦–å…ˆä»‹ç»ä¸‹x64dbgç»å¸¸ä½¿ç”¨çš„å¿«æ·é”®ï¼Œéƒ¨åˆ†åŒODå¿«æ·é”® - F3: ç¨‹åºè½½å…¥å¿«æ·é”® - F4: è¿è¡Œç¨‹åºåˆ°å…‰æ ‡å¤„ - F7: å•æ­¥æ­¥å…¥(ç±»ä¼¼vs F11) - F8: å•æ­¥æ­¥è¿‡(ç±»ä¼¼vs F10) - F9: è¿è¡Œç¨‹åº(ç±»ä¼¼vs F5) - F12: æš‚åœç¨‹åº - Ctrl + F2 é‡æ–°è¿è¡Œç¨‹åº - Alt + F9 è¿è¡Œåˆ°ç”¨æˆ·ä»£ç  ğŸŒŸ 2.æ‰“å¼€x32dbg.exeï¼ŒæŒ‰F3è½½å…¥dynamic_anti_01.exeç¨‹åº > 3.æ‰“å¼€ç¬¦å·çª—å£ï¼Œè¿™é‡Œéœ€è¦åŠ è½½æ‰€ä¾èµ–çš„Windowsæ¨¡å—çš„ç¬¦å·æ–‡ä»¶ï¼Œåªæœ‰çŸ¥é“äº†åº”ç”¨ç¨‹åºä½¿ç”¨äº†å“ªäº›APIæˆ‘ä»¬æ‰èƒ½å¤Ÿé€†å‘å®ƒçš„å®ç° > 4.å¯»æ‰¾å…³é”®ç‚¹ï¼Œæˆ‘ä»¬ç°åœ¨æ˜¯ä¸çŸ¥é“å®ƒæ˜¯æ€ä¹ˆéªŒè¯ï¼Œæ‰€ä»¥éœ€è¦æ‰¾åˆ°éªŒè¯ç”¨æˆ·åå£ä»¤çš„å‡½æ•°å®ç°å…¥å£ï¼Œå¦‚ä½•æ‰¾åˆ°å‘¢ï¼Ÿ Aï¼šå•æ­¥æ‰§è¡Œæ˜¯å¦å¯ä»¥ï¼Ÿé‡åˆ°å¤ªå¤§çš„APIè°ƒç”¨å°±ä¸‹æ–­ç‚¹ï¼Œç„¶åé‡æ–°è¿è¡Œï¼Œæ­¥å…¥é˜»å¡çš„å‡½æ•°ï¼Œå¦‚æ­¤å¾ªç¯ï¼Ÿ Q: é€šè¿‡å°è¯•ä½ ä¼šè¿›å…¥Windowsçš„æ¶ˆæ¯å¾ªç¯ä¸­ï¼Œè€Œä¸”æåˆ°ç²¾ç–²åŠ›å°½ï¼Œè¾ƒéš¾å‘ç°éªŒè¯ç‚¹ï¼Œæœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•å‘¢ï¼Ÿ æ³¨æ„: Alt + F9å¿«æ·é”®ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°è¯•é”™è¯¯çš„ç”¨æˆ·åå£ä»¤ï¼Œç„¶åæš‚åœç¨‹åºè¿è¡Œï¼Œå†æŒ‰Alt + F9ç»„åˆé”®è®©ç¨‹åºè¿”å›ç”¨æˆ·ä»£ç æ—¶ï¼Œè‡ªåŠ¨åœæ­¢ï¼Œç„¶åå†å•æ­¥è¿è¡Œå°±å¯ä»¥æ‰¾åˆ°éªŒè¯çš„å…¥å£ç‚¹äº† æˆ‘ä»¬éšä¾¿è¾“å…¥ä¸€ç»„é”™è¯¯çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œè¿™æ—¶å€™å¦æŒ‰F12ç´§æ¥ç€æŒ‰Alt + F9ç™»å½•å°ç¨‹åºä¼šç»§ç»­è¿è¡Œï¼Œç„¶åå†ç‚¹å‡» [ç¡®å®š] æŒ‰é’®å°è¯•ç™»å½•ï¼Œå¼¹å‡ºé”™è¯¯é€‰æ‹©æ¡†è·³å‡ºæ¥åç‚¹å‡»ç¡®å®šï¼Œæ­¤æ—¶x64dbgä¼šæ–­ç‚¹åˆ°ç”¨æˆ·åŒºåŸŸï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 5.ä»ä¸Šå›¾å¯åˆ†æå‡ºï¼Œè¯¥ä»£ç åŒºåŸŸå°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„å…¥å£ç‚¹ï¼Œå¯ä½¿ç”¨Ctrl + Aè®©x64dbgä¸ºæˆ‘ä»¬è¿›ä¸€æ­¥è§£ææ­¤å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ–­ç‚¹ä¸‹åˆ°è¯¥å‡½æ•°å…¥å£å¤„ï¼ŒCtrl + F2é‡æ–°è¿è¡Œè¯¥ç¨‹åºï¼Œè¾“å…¥ä¸€ç»„é”™è¯¯æ•°æ®ï¼Œç‚¹å‡»ç¡®å®šåä¼šå‘½ä¸­æˆ‘é—¨æ‰“çš„æ–­ç‚¹ > 6.å•æ­¥è°ƒè¯•æ—¶ï¼Œä¸»è¦å…³æ³¨`cmp`å’Œ`jmp, je, jne`æŒ‡ä»¤ï¼Œå³å¯æ‰¾åˆ°å…³é”®ä½ç½®ï¼ŒåŒæ—¶ä½ ä¹Ÿå¯ä»¥ä¿®æ”¹å¯¹åº”çš„æ ‡å¿—ä¸ºï¼Œä»è€Œæ”¹å˜ç¨‹åºçš„è¿è¡Œé€»è¾‘ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º: ä»¥ä¸Šä¸ºåŠ¨æ€è°ƒè¯•ï¼Œä½ ä¼šå‘ç°è¾“å…¥äº†é”™è¯¯çš„ç”¨æˆ·åå¯†ç ï¼Œä¹Ÿå¼¹å‡ºäº†éªŒè¯æˆåŠŸçš„æç¤ºï¼ å‚è€ƒèµ„æ–™ PEæ–‡ä»¶ç»“æ„è¯¦è§£ æ·±å…¥ç†è§£Windowsçº¿ç¨‹ å°ç”²é±¼ OllyDbg æ•™ç¨‹ç³»åˆ—","categories":[{"name":"anti","slug":"anti","permalink":"http://localhost:4000/categories/anti/"}],"tags":[{"name":"windows","slug":"windows","permalink":"http://localhost:4000/tags/windows/"},{"name":"anti","slug":"anti","permalink":"http://localhost:4000/tags/anti/"}]},{"title":"Hello World","slug":"hello-world","date":"2022-07-29T00:53:18.217Z","updated":"2022-08-01T05:39:59.078Z","comments":true,"path":"2022/07/29/hello-world/","link":"","permalink":"http://localhost:4000/2022/07/29/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}],"categories":[{"name":"anti","slug":"anti","permalink":"http://localhost:4000/categories/anti/"}],"tags":[{"name":"windows","slug":"windows","permalink":"http://localhost:4000/tags/windows/"},{"name":"anti","slug":"anti","permalink":"http://localhost:4000/tags/anti/"}]}